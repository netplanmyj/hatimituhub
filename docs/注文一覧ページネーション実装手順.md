# 注文一覧ページのページネーション実装手順

## 概要
注文一覧ページ（OrderListPage）で、1ページ10件ずつ表示し「前へ」「次へ」ボタンでページ送りできるページネーションを実装します。

## 1. Firestoreクエリの変更
- `limit(10)` で1ページ10件取得
- ページ送り時は `startAfterDocument` で次の10件を取得

## 2. Widget構造の変更
- `OrderListPage` を `StatefulWidget` に変更
- ページ送り用の状態（orders, lastDocument, currentPage, hasMore, isLoading）を管理
- ボタンで `fetchOrders()` を呼び出し、ordersリストを更新

## 3. 実装例
```dart
class OrderListPage extends StatefulWidget {
  const OrderListPage({super.key});
  @override
  State<OrderListPage> createState() => _OrderListPageState();
}

class _OrderListPageState extends State<OrderListPage> {
  static const int pageSize = 10;
  List<DocumentSnapshot> orders = [];
  DocumentSnapshot? lastDocument;
  int currentPage = 0;
  bool isLoading = false;
  bool hasMore = true;

  @override
  void initState() {
    super.initState();
    fetchOrders(reset: true);
  }

  Future<void> fetchOrders({bool reset = false}) async {
    setState(() { isLoading = true; });
    Query query = FirebaseFirestore.instance
      .collection('orders')
      .orderBy('createdAt', descending: true)
      .limit(pageSize);
    if (!reset && lastDocument != null) {
      query = query.startAfterDocument(lastDocument!);
    }
    final snapshot = await query.get();
    orders = snapshot.docs;
    if (reset) {
      currentPage = 0;
    } else {
      currentPage++;
    }
    lastDocument = snapshot.docs.isNotEmpty ? snapshot.docs.last : lastDocument;
    hasMore = snapshot.docs.length == pageSize;
    setState(() { isLoading = false; });
  }

  void goToNextPage() {
    if (hasMore && !isLoading) {
      fetchOrders();
    }
  }
  void goToPrevPage() {
    if (currentPage > 0 && !isLoading) {
      fetchOrders(reset: true);
      currentPage--;
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('注文一覧')),
      body: isLoading
        ? const Center(child: CircularProgressIndicator())
        : orders.isEmpty
          ? const Center(child: Text('注文データがありません'))
          : Column(
              children: [
                Expanded(
                  child: ListView.builder(
                    itemCount: orders.length,
                    itemBuilder: (context, index) {
                      // ...注文データ表示...
                    },
                  ),
                ),
                Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    ElevatedButton(
                      onPressed: currentPage > 0 ? goToPrevPage : null,
                      child: const Text('前へ'),
                    ),
                    const SizedBox(width: 16),
                    ElevatedButton(
                      onPressed: hasMore ? goToNextPage : null,
                      child: const Text('次へ'),
                    ),
                  ],
                ),
              ],
            ),
    );
  }
}
```

## 4. テスト例
- ダミーリストでページ送りロジック（10件ずつ取得、端数ページ）を検証
- `test/order_list_test.dart` にサンプル追加

## 5. 注意点
- Firestoreのデータ件数が10件未満の場合は「次へ」ボタンが無効化されます
- ページ送り時はordersリストを毎回上書きし、前ページのデータが残らないようにします

---

この手順で注文一覧ページのページネーションが実装できます。運用やUI調整はプロジェクト要件に応じて追加してください。
